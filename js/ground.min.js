function extractDataFromHeightMap(e,t,n){var r=new Image;r.onload=function(){var e=document.createElement("canvas");var i=e.getContext("2d");var s=r.width;var o=r.height;e.width=s;e.height=o;i.drawImage(r,0,0);var u=i.getImageData(0,0,s,o).data;var a=[];for(var f=0,l=u.length;f<l;f+=s*4){a.push([]);for(var c=f,h=f+s*4;c<h;c+=4){var p=u[c]/255;var d=u[c+1]/255;var v=u[c+2]/255;var m=p*.3+d*.59+v*.11;a[f/(s*4)].push(m*t)}}n(a)};r.src=e}function createGroundFromData(e,t,n,r,i,s,o){var u=new BABYLON.Mesh(e,s);var a=[];var f=[];var l=[];var c=[];var h,p;for(h=0;h<=i;h++){for(p=0;p<=i;p++){var d=new BABYLON.Vector3(p*n/i-n/2,0,(i-h)*r/i-r/2);d.y=getPosY(d.x,d.z,t,n,r);f.push(d.x,d.y,d.z);l.push(0,0,0);c.push(p/i,1-h/i)}}for(h=0;h<i;h++){for(p=0;p<i;p++){a.push(p+1+(h+1)*(i+1));a.push(p+1+h*(i+1));a.push(p+h*(i+1));a.push(p+(h+1)*(i+1));a.push(p+1+(h+1)*(i+1));a.push(p+h*(i+1))}}BABYLON.Mesh.ComputeNormal(f,l,a);u.setVerticesData(f,BABYLON.VertexBuffer.PositionKind,o);u.setVerticesData(l,BABYLON.VertexBuffer.NormalKind,o);u.setVerticesData(c,BABYLON.VertexBuffer.UVKind,o);u.setIndices(a);return u}function getPosY(e,t,n,r,i){var s=(e+r/2)/r*(n.length-1)|0;var o=(1-(t+i/2)/i)*(n[0].length-1)|0;return s<0||s>=n.length||o<0||o>=n[0].length?0:n[s][o]}